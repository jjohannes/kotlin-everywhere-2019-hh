<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>: Structure your Project with Gradle by using Kotlin Everywhere</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/gradle.css" id="theme" /><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-player.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-theme-gradle.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/highlight-theme.css" />
<script src="reveal.js/css/theme/asciinema-player.js"></script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-transition="zoom" data-transition-speed="fast" data-background-image="./images/title.png"><h1></h1><h2>Structure your Project with Gradle by using Kotlin Everywhere</h2><div class="preamble"><div class="paragraph"><p><h3>
KOTLIN/Everywhere Hamburg 2019
</h3></p></div></div></section>
<section id="who-is-gradle" data-transition="none"><h2>Who is Gradle?</h2><div class="imageblock" style=""><img src="./images/gradle-staff-map.png" alt="gradle staff map" width="1000" height="0%" /></div></section>
<section id="what-is-gradle" data-transition="none"><h2>What is Gradle?</h2><div class="imageblock" style=""><img src="./images/gradle-structure.png" alt="gradle structure" width="1000" height="0%" /></div></section>
<section><section id="model-your-project-with-gradle-and-kotlin-your-project-as-software-components" data-transition="none" data-background-color="#01303a"><h2>Model Your Project with Gradle and Kotlin: Your Project as Software Components</h2></section><section id="your-project-as-a-software-component" data-transition="none"><h2>Your Project as a Software Component</h2><div class="imageblock" style=""><img src="./images/components0.png" alt="components0" width="300" height="0%" /></div></section><section id="don-t-be-afraid-of-gradle-it-s-just-kotlin" data-transition="none"><h2>Don&#8217;t be afraid of Gradle - it&#8217;s just Kotlin</h2><div class="paragraph"><p><code>build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">// empty file</code></pre>
<div class="paragraph"><p><code>settings.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">rootProject.name = "kotlin-everywhere"</code></pre></section><section id="don-t-be-afraid-of-gradle-it-s-just-kotlin-2" data-transition="none"><h2>Don&#8217;t be afraid of Gradle - it&#8217;s just Kotlin</h2><div class="paragraph"><p><code>build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">tasks.register("t1") {
    inputs.dir("...")
    ouptuts.file("...")
    doLast {
        ...
    }
}</code></pre>
<div class="paragraph"><p><code>settings.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">rootProject.name = "kotlin-everywhere"</code></pre></section><section id="don-t-be-afraid-of-gradle-it-s-just-kotlin-3" data-transition="none"><h2>Don&#8217;t be afraid of Gradle - it&#8217;s just Kotlin</h2><div class="paragraph"><p><code>build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">tasks.register("t1") {
    inputs.dir("...")
    ouptuts.file("...")
    doLast {
        // do some work
    }
}</code></pre>
<div class="paragraph"><p><code>settings.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">rootProject.name = "kotlin-everywhere"</code></pre></section><section id="don-t-be-afraid-of-gradle-it-s-just-kotlin-4" data-transition="none"><h2>Don&#8217;t be afraid of Gradle - it&#8217;s just Kotlin</h2><div class="paragraph"><p><code>buildSrc/src/main/kotlin/MyProject.kt</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">fun org.gradle.api.Project.configureMyProject() {
    tasks.register("t1") {
        inputs.dir("...")
        ouptuts.file("...")
        doLast {
            // do some work
        }
    }
}</code></pre>
<div class="paragraph"><p><code>build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configureMyProject()</code></pre>
<div class="paragraph"><p>You define a model of your software project through a Java/Kotlin API</p></div>
<div class="paragraph"><p>Entry point: <code>org.gradle.api.Project</code></p></div></section><section id="your-project-as-a-software-component-2" data-transition="none"><h2>Your Project as a Software Component</h2><div class="imageblock" style=""><img src="./images/components1.png" alt="components1" width="300" height="0%" /></div>
<div class="paragraph"><p>You define a model of your software project through a Java/Kotlin API</p></div>
<div class="paragraph"><p>Entry point: <code>org.gradle.api.Project</code></p></div></section><section id="your-project-as-a-software-component-3" data-transition="none"><h2>Your Project as a Software Component</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">fun org.gradle.api.Project.configureMyProject() {
    println("Tasks: ${tasks.size}")
    plugins.apply("java")
    println("Tasks: ${tasks.size} (Java plugin added)")
    plugins.apply("org.jetbrains.kotlin.jvm")
    println("Tasks: ${tasks.size} (Kotlin plugin added)")
    plugins.apply("com.android.application")
    println("Tasks: ${tasks.size} (Android plugin added)")
}</code></pre>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">&gt; Configure project :
Tasks: 16
Tasks: 31 (Java plugin added)
Tasks: 36 (Kotlin plugin added)
Tasks: 49 (Android plugin added)</code></pre>
<div class="paragraph"><p>You define a model of your software project through a Java/Kotlin API</p></div>
<div class="paragraph"><p>Entry point: <code>org.gradle.api.Project</code></p></div></section><section id="your-project-as-a-software-component-4" data-transition="none"><h2>Your Project as a Software Component</h2><div class="imageblock" style=""><img src="./images/components2.png" alt="components2" width="300" height="0%" /></div>
<div class="paragraph"><p>You define a model of your software project through a Java/Kotlin API</p></div>
<div class="paragraph"><p>Entry point: <code>org.gradle.api.Project</code></p></div></section><section id="your-project-as-multiple-software-components" data-transition="none"><h2>Your Project as multiple Software Components</h2><div class="imageblock" style=""><img src="./images/components3.png" alt="components3" width="500" height="0%" /></div>
<div class="paragraph"><p><code>settings.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">include("user-data", "account-data", "services", "desktop-app", "android-app")</code></pre></section><section id="your-project-as-multiple-software-components-2" data-transition="none"><h2>Your Project as multiple Software Components</h2><div class="imageblock" style=""><img src="./images/components5.png" alt="components5" width="500" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">project(":user-data").plugins.apply("java")
project(":account-data").plugins.apply("java")
project(":services").plugins.apply("org.jetbrains.kotlin.jvm")
project(":desktop-app").plugins.apply("org.jetbrains.kotlin.jvm")
project(":android-app").plugins.apply("org.jetbrains.kotlin.android")
project(":android-app").plugins.apply("com.android.application")</code></pre></section><section id="your-project-as-multiple-software-components-3" data-transition="none"><h2>Your Project as multiple Software Components</h2><div class="imageblock" style=""><img src="./images/components4.png" alt="components4" width="650" height="0%" /></div>
<div class="paragraph"><p><code>settings.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">include("user-data", "account-data", "services", "desktop-app", "android-app")
rootProject.children.forEach {
    val base = when(it.name) {
        "user-data"    -&gt; "data"
        "account-data" -&gt; "data"
        "services"     -&gt; "services"
        else           -&gt; "apps"
    }
    it.projectDir = file("$base/${it.name}")
}</code></pre></section></section>
<section><section id="model-your-project-with-gradle-and-kotlin-variant-aware-dependency-management" data-transition="none" data-background-color="#01303a"><h2>Model Your Project with Gradle and Kotlin: Variant-Aware Dependency Management</h2></section><section id="dependency-management" data-transition="none"><h2>Dependency Management</h2><div class="imageblock" style=""><img src="./images/components2-1.png" alt="components2 1" width="600" height="0%" /></div></section><section id="variant-aware-dependency-management" data-transition="none"><h2>Variant-Aware Dependency Management</h2><div class="imageblock" style=""><img src="./images/components2-1.png" alt="components2 1" width="600" height="0%" /></div>
<div class="paragraph"><p>Entry point: <code>org.gradle.api.artifacts.Configuration</code> (API for 3 concepts)</p></div>
<div class="ulist"><ul><li><p><strong>Provide</strong>: define sets of artifacts I produce for other projects</p></li><li><p><strong>Consume</strong>: define sets of dependencies to projects and modules</p></li><li><p><strong>Resolve</strong>: tool to collect artifacts from dependencies (e.g. all <em>jars</em>)</p></li></ul></div></section><section id="variant-aware-dependency-management-2" data-transition="none"><h2>Variant-Aware Dependency Management</h2><div class="imageblock" style=""><img src="./images/components2-2-1.png" alt="components2 2 1" width="400" height="0%" /></div>
<div class="paragraph"><p><strong>Provide</strong>: define sets of artifacts I produce for other projects (:services)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val everythingYouNeedToRunMe by configurations.creating {
    isCanBeResolved = false; isCanBeConsumed = true // this is a variant!
}</code></pre></section><section id="variant-aware-dependency-management-3" data-transition="none"><h2>Variant-Aware Dependency Management</h2><div class="imageblock" style=""><img src="./images/components2-2-2.png" alt="components2 2 2" width="600" height="0%" /></div>
<div class="paragraph"><p><strong>Provide</strong>: define sets of artifacts I produce for other projects (:services)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val everythingYouNeedToRunMe by configurations.creating {
    isCanBeResolved = false; isCanBeConsumed = true // this is a variant!
    extendsFrom(otherComponentsINeedToRun)
}</code></pre>
<div class="paragraph"><p><strong>Consume</strong>: define sets of dependencies to projects and modules (:desktop-app)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val otherComponentsINeedToRun by configurations.creating {
    isCanBeResolved = false; isCanBeConsumed = false // this is a bucket!
}
dependencies {
    otherComponentsINeedToRun(project(":services"))
}</code></pre></section><section id="variant-aware-dependency-management-4" data-transition="none"><h2>Variant-Aware Dependency Management</h2><div class="imageblock" style=""><img src="./images/components2-2-3.png" alt="components2 2 3" width="600" height="0%" /></div>
<div class="paragraph"><p><strong>Resolve</strong>: tool to collect artifacts from dependencies (e.g. all <em>jars</em>)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val pathToAllFiles by configurations.creating {
    isCanBeResolved = true; isCanBeConsumed = false // this is a tool!
    extendsFrom(otherComponentsINeedToRun)
}
tasks.register("allFiles") {
    doLast {
        println(configurations["pathToAllFiles"].incoming
            .artifacts.artifactFiles.map { it.name })
    }
}</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:allFiles</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">&gt; Task :desktop-app:allFiles
[services.jar, services-sources.jar]</code></pre></section><section id="consume-other-projects-and-modules" data-transition="none"><h2>Consume other Projects and Modules</h2><div class="imageblock" style=""><img src="./images/components2-4.png" alt="components2 4" width="900" height="0%" /></div>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation(project(":services"))
}</code></pre>
<div class="paragraph"><p><code>services/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    api(project(":user-data"))
    implementation("com.conversantmedia:disruptor:1.2.15")
}</code></pre></section><section id="resolve-with-variant-selection" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-5.png" alt="components2 5" width="900" height="0%" /></div>
<div class="paragraph"><p><code>gradlew desktop-app:dependencies --configuration compileClasspath</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">compileClasspath
\--- project :services
     \--- project :user-data</code></pre></section><section id="resolve-with-variant-selection-2" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-6.png" alt="components2 6" width="900" height="0%" /></div>
<div class="paragraph"><p><code>gradlew desktop-app:dependencies --configuration compileClasspath</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">compileClasspath
\--- project :services
     \--- project :user-data</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:dependencies --configuration runtimeClasspath</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">runtimeClasspath
\--- project :services
     +--- project :user-data
     \--- com.conversantmedia:disruptor:1.2.15
          \--- org.slf4j:slf4j-api:1.7.13</code></pre></section><section id="resolve-with-variant-selection-3" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-7.png" alt="components2 7" width="900" height="0%" /></div>
<div class="paragraph"><p><code>gradlew services:outgoingVariants</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="xml language-xml">Variant api-variant
--------------------------------------------------
Attributes
- org.gradle.jvm.version         = 11
- org.gradle.libraryelements     = classes
- org.gradle.usage               = java-api</code></pre>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations["compileClasspath"].attributes {
    attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
}</code></pre></section><section id="resolve-with-variant-selection-4" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-8.png" alt="components2 8" width="900" height="0%" /></div>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations["compileClasspath"].attributes {
    attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
}</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:dependencies --configuration compileClasspath</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">compileClasspath
\--- project :services
     +--- project :user-data
     \--- com.conversantmedia:disruptor:1.2.15
          \--- org.slf4j:slf4j-api:1.7.13</code></pre></section><section id="resolve-with-variant-selection-5" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-9.png" alt="components2 9" width="900" height="0%" /></div>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations["runtimeClasspath"].attributes {

}</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:allFiles</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">&gt; Task :desktop-app:allFiles
[services.jar, user-data.jar, disruptor-1.2.15.jar,
 slf4j-api-1.7.13.jar]</code></pre></section><section id="resolve-with-variant-selection-6" data-transition="none"><h2>Resolve with Variant Selection</h2><div class="imageblock" style=""><img src="./images/components2-10.png" alt="components2 10" width="900" height="0%" /></div>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations["runtimeClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:allFiles</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">&gt; Task :desktop-app:allFiles
[services-jdk8.jar, user-data-jdk8.jar,
 disruptor-1.2.15.jar, slf4j-api-1.7.13.jar]</code></pre></section><section id="what-about-published-modules" data-transition="none"><h2>What about Published Modules?</h2><div class="imageblock" style=""><img src="./images/components2-12.png" alt="components2 12" width="900" height="0%" /></div>
<div class="ulist"><ul><li><p>For projects: Gradle has the full model in memory</p></li><li><p>For modules: Gradle needs to build the model from metadata</p></li></ul></div></section><section id="pom-module-metadata" data-transition="none"><h2>POM Module Metadata</h2><div class="imageblock" style=""><img src="./images/components2-13.png" alt="components2 13" width="900" height="0%" /></div>
<div class="paragraph"><p><code>com/conversantmedia/disruptor/1.2.15/disruptor-1.2.15.pom</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="xml language-xml">&lt;groupId&gt;com.conversantmedia&lt;/groupId&gt;
&lt;artifactId&gt;disruptor&lt;/artifactId&gt;
&lt;packaging&gt;jar&lt;/packaging&gt;
&lt;version&gt;1.2.15&lt;/version&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
    &lt;version&gt;1.7.13&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;</code></pre></section><section id="pom-module-metadata-2" data-transition="none"><h2>POM Module Metadata</h2><div class="imageblock" style=""><img src="./images/components2-14.png" alt="components2 14" width="900" height="0%" /></div>
<div class="paragraph"><p><code>com/conversantmedia/disruptor/1.2.15/*.jar</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="sh language-sh">disruptor-1.2.15-jdk10.jar      2018-12-20 14:41    134319
disruptor-1.2.15-jdk8.jar       2018-12-20 14:41    134482
disruptor-1.2.15.jar            2018-12-20 14:41    134482</code></pre></section><section id="gradle-module-metadata-gmm" data-transition="none"><h2>Gradle Module Metadata (GMM)</h2><div class="imageblock" style=""><img src="./images/components2-15.png" alt="components2 15" width="900" height="0%" /></div>
<div class="paragraph"><p><code>disruptor-1.2.15.module</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="json language-json">"component": { "group": "com.conversantmedia", "module": "disruptor", "version": "1.2.15" },
"variants": [
  { "name": "runtimeElements",
    "attributes": { "org.gradle.jvm.version": 11, "org.gradle.usage": "java-runtime" },
    "dependencies": [{ "group": "org.slf4j", "module": "slf4j-api", "version": { "requires": "1.7.13" }}],
    "files": [{ "name": "conversantmedia-1.2.15.jar", "url": "conversantmedia-1.2.15.jar" }] },
  { "name": "jdk8RuntimeElements",
    "attributes": { "org.gradle.jvm.version": 8, "org.gradle.usage": "java-runtime" },
    "dependencies": [{ "group": "org.slf4j", "module": "slf4j-api", "version": { "requires": "1.7.13" }}],
    "files": [{ "name": "conversantmedia-1.2.15-jdk8.jar", "url": "conversantmedia-1.2.15-jdk8.jar" }]
  },</code></pre></section><section id="variant-selection-on-projects-and-modules" data-transition="none"><h2>Variant Selection on Projects and Modules</h2><div class="imageblock" style=""><img src="./images/components2-15.png" alt="components2 15" width="900" height="0%" /></div>
<div class="paragraph"><p><code>desktop-app/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations["runtimeClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}</code></pre>
<div class="paragraph"><p><code>gradlew desktop-app:allFiles</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">&gt; Task :desktop-app:allFiles
[services-jdk8.jar, user-data-jdk8.jar,
 disruptor-1.2.15-jdk8.jar, slf4j-api-1.7.13.jar]</code></pre></section></section>
<section><section id="model-your-project-with-gradle-and-kotlin-features-building-on-variant-aware-dependency-management" data-transition="none" data-background-color="#01303a"><h2>Model Your Project with Gradle and Kotlin: Features building on Variant-Aware Dependency Management</h2></section><section id="handle-conflicting-implementations" data-transition="none"><h2>Handle conflicting Implementations</h2><div class="imageblock" style=""><img src="./images/components3-2-1.png" alt="components3 2 1" width="600" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("velocity:velocity:1.5")
    implementation("org.slf4j:log4j-over-slf4j:1.7.10")
}</code></pre>
<div class="ulist"><ul><li><p><strong>Capabilities</strong>: Provided by variants, each can be provided only once</p></li><li><p><strong>Attributes</strong>: Define which implementation of a capability fits best</p></li></ul></div></section><section id="handle-conflicting-implementations-2" data-transition="none"><h2>Handle conflicting Implementations</h2><div class="imageblock" style=""><img src="./images/components3-2-2.png" alt="components3 2 2" width="800" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("velocity:velocity:1.5")
    implementation("org.slf4j:log4j-over-slf4j:1.7.10")
}</code></pre>
<div class="ulist"><ul><li><p><strong>Capabilities</strong>: Provided by variants, each can be provided only once</p></li><li><p><strong>Attributes</strong>: Define which implementation of a capability fits best</p></li></ul></div></section><section id="handle-conflicting-implementations-3" data-transition="none"><h2>Handle conflicting Implementations</h2><div class="imageblock" style=""><img src="./images/components3-2-3.png" alt="components3 2 3" width="800" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("velocity:velocity:1.5")
    implementation("org.slf4j:log4j-over-slf4j:1.7.10")
}</code></pre>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">Cannot select module with conflict on capability 'log4j:log4j:1.2.12'
also provided by [org.slf4j:log4j-over-slf4j:1.7.13(api-variant)]</code></pre></section><section id="handle-conflicting-implementations-4" data-transition="none"><h2>Handle conflicting Implementations</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">class LoggingCapability : ComponentMetadataRule {
  val loggingModules = setOf("log4j", "log4j-over-slf4j")
  override fun execute(ctx: ComponentMetadataContext) = ctx.details.run {
    if (loggingModules.contains(id.name)) {
      allVariants {
        withCapabilities { addCapability("log4j", "log4j", id.version) }
      }
    }
  }
}</code></pre>
<div class="ulist"><ul><li><p><strong>Component Metadata Rules</strong>: Add missing metadata</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">configurations.all {
  resolutionStrategy.capabilitiesResolution.withCapability("log4j:log4j") {
    select(candidates.find { it.module == "log4j-over-slf4j" })
    because("use slf4j in place of log4j")
  }
}</code></pre>
<div class="ulist"><ul><li><p><strong>Capability Resolution Strategy</strong>: Decide what fits in your context</p></li></ul></div></section><section id="test-fixtures" data-transition="none"><h2>Test Fixtures</h2><div class="paragraph"><p><code>user-data/src/main/java/com/acme/User.kt</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">data class User(val firstName: String, val lastName: String)</code></pre>
<div class="paragraph"><p><code>user-data/src/testFixtures/java/com/acme/Simpsons.kt</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">object Simpsons {
    val HOMER  = User("Homer", "Simpson")
    val MARGE  = User("Majorie", "Simpson")
    val BART   = User("Bartholomew", "Simpson")
    val LISA   = User("Elisabeth Marie", "Simpson")
    val MAGGIE = User("Margaret Eve", "Simpson")
    val FAMILY = setOf(HOMER, MARGE, BART, LISA, MAGGIE)
}</code></pre>
<div class="paragraph"><p><code>user-data/build.gradle.kts</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins {
    `java-library`
    `java-test-fixtures` // new plugin since Gradle 5.6
    `maven-publish`      // you can publish test fixtures with GMM!
}</code></pre></section><section id="test-fixtures-2" data-transition="none"><h2>Test Fixtures</h2><div class="imageblock" style=""><img src="./images/components3-1.png" alt="components3 1" width="900" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    api(project(":user-data"))
    implementation("com.conversantmedia:disruptor:1.2.15")
    testImplementation(testFixtures(project(":user-data")))
    testImplementation(testFixtures("com.conversantmedia:disruptor:1.2.15"))
}</code></pre></section><section id="versions-and-version-conflicts" data-transition="none"><h2>Versions and Version Conflicts</h2><div class="imageblock" style=""><img src="./images/components3-3.png" alt="components3 3" width="600" height="0%" /></div>
<div class="ulist"><ul><li><p>For projects: Gradle always uses/builds the working copy</p></li><li><p>For modules: Gradle needs to choose a version</p><div class="ulist"><ul><li><p>Gradle considers <strong>all</strong> version constraints in the dependency graph</p></li></ul></div></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("com.conversantmedia:disruptor:1.2.15")
    api("org.slf4j:slf4j-api") {
        version { requires("1.6.6") }
    }
}</code></pre></section><section id="versions-and-version-conflicts-2" data-transition="none"><h2>Versions and Version Conflicts</h2><div class="imageblock" style=""><img src="./images/components3-4.png" alt="components3 4" width="600" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("com.conversantmedia:disruptor:1.2.15")
    constraints {
        api("org.slf4j:slf4j-api") {
            version {
                requires("1.6.6")
            }
        }
    }
}</code></pre></section><section id="versions-and-version-conflicts-3" data-transition="none"><h2>Versions and Version Conflicts</h2><div class="imageblock" style=""><img src="./images/components3-5.png" alt="components3 5" width="600" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("com.conversantmedia:disruptor:1.2.15")
    constraints {
        api("org.slf4j:slf4j-api") {
            version {
                requires("1.6.6")
                forSubgraph()
            }
        }
    }
}</code></pre></section><section id="platforms-for-managing-dependency-versions" data-transition="none"><h2>Platforms for Managing Dependency Versions</h2><div class="imageblock" style=""><img src="./images/components3-6.png" alt="components3 6" width="680" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins { `java-platform` }
dependencies {
    constraints {
        api("com.conversantmedia:disruptor:1.2.15")
        api("org.slf4j:slf4j-api:1.6.6") { version { forSubgraph() } }
    }
}</code></pre></section><section id="platforms-for-managing-dependency-versions-2" data-transition="none"><h2>Platforms for Managing Dependency Versions</h2><div class="imageblock" style=""><img src="./images/components3-7.png" alt="components3 7" width="680" height="0%" /></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    api(platform(project(":my-platform")))
    implementation("com.conversantmedia:disruptor")
}</code></pre></section></section>
<section id="maybe-try-a-build-scan-with-gradle-enterprise" data-transition="none"><h2>Maybe try a Build Scan with Gradle Enterprise</h2><div class="imageblock" style=""><img src="./images/scan-httpclient.png" alt="scan httpclient" width="800" height="0%" /></div>
<div class="imageblock" style=""><img src="./images/scan-httpclient-comparison.png" alt="scan httpclient comparison" width="800" height="0%" /></div></section>
<section id="remember" data-transition="none"><h2>Remember&#8230;&#8203;</h2><div class="ulist"><ul><li><p>With Gradle you model your project through a Java/Kotlin API</p><div class="ulist"><ul><li><p><code>org.gradle.api.Project</code> (basic building blocks, apply plugins here)</p></li><li><p><code>org.gradle.api.Task</code> (not covered today, let plugins add them)</p></li><li><p><code>org.gradle.api.artifacts.Configuration</code> (good stuff is hidden here)</p></li></ul></div></li><li><p>Use variants as interface between projects and modules</p><div class="ulist"><ul><li><p><em>Variant Attributes</em> and <em>Capabilities</em> 😳</p></li><li><p>Gradle 6.0 will go full steam on Gradle Module Metadata (GMM) 🚀</p></li><li><p>All new features shown are compatible with GMM 🥳</p></li><li><p>Configuration is the entry point (better APIs will follow) 🙈</p></li></ul></div></li></ul></div></section>
<section id="thank-you" data-transition="none"><h2>Thank you</h2><div class="paragraph"><p>📽️ <a href="https://jjohannes.github.io/kotlin-everywhere-2019-hh">jjohannes.github.io/kotlin-everywhere-2019-hh</a></p></div>
<div class="paragraph"><p>🐘 <a href="https://github.com/gradle/gradle">github.com/gradle/gradle</a></p></div>
<div class="paragraph"><p>🕊️ <a href="https://twitter.com/jeoj">@jeoj</a></p></div>
<div class="paragraph"><p>😺 <a href="https://github.com/jjohannes">@jjohannes</a></p></div></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script><!-- this currently shows up at the wrong location in the final index.html which means the style font is not properly applied-->

<div class="footer">
</div></body></html>